<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>MPP3 Emergency System</title>

  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", Tahoma, sans-serif;
      background: linear-gradient(135deg, #fff7cc, #cce7ff);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .container {
      background: white;
      width: 90%;
      max-width: 500px;
      border-radius: 20px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.2);
      padding: 25px;
      text-align: center;
    }

    .logo {
      font-size: 48px;
      font-weight: bold;
      color: #f4b400;
      margin-bottom: 10px;
    }

    h1 {
      font-size: 22px;
      color: #0277bd;
      margin-bottom: 5px;
    }

    h2 {
      font-size: 16px;
      color: #555;
      margin-bottom: 20px;
    }

    button {
      background: linear-gradient(135deg, #ffd54f, #4fc3f7);
      border: none;
      border-radius: 30px;
      padding: 12px 25px;
      font-size: 18px;
      cursor: pointer;
      color: #003366;
      font-weight: bold;
      margin-bottom: 20px;
      transition: transform 0.2s;
    }

    button:hover {
      transform: scale(1.05);
    }

    .status {
      background: #f5f5f5;
      border-radius: 10px;
      padding: 10px;
      margin-bottom: 10px;
      font-size: 14px;
    }

    .alert-box {
      border: 2px dashed #ff5252;
      border-radius: 10px;
      padding: 15px;
      min-height: 80px;
      font-size: 18px;
      color: #d32f2f;
      font-weight: bold;
    }

    footer {
      margin-top: 15px;
      font-size: 12px;
      color: #777;
    }
  </style>
</head>

<body>

  <div class="container">
    <div class="logo">MPP3</div>

    <h1>‡∏£‡∏∞‡∏ö‡∏ö‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÅ‡∏•‡∏∞‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏‡∏â‡∏∏‡∏Å‡πÄ‡∏â‡∏¥‡∏ô</h1>
    <h2>‡πÇ‡∏£‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏û‡∏±‡∏ä‡∏£‡∏Å‡∏¥‡∏ï‡∏¥‡∏¢‡∏≤‡∏†‡∏≤ ‡πì ‡∏™‡∏∏‡∏£‡∏≤‡∏©‡∏é‡∏£‡πå‡∏ò‡∏≤‡∏ô‡∏µ</h2>

    <button onclick="connect()">üîµ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ micro:bit</button>

    <div class="status" id="status">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</div>

    <div class="alert-box" id="alert">
      ‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏...
    </div>

    <footer>
      Emergency Assistance System | MPP3
    </footer>
  </div>

  <script>
    const UART_SERVICE = "6e400001-b5a3-f393-e0a9-e50e24dcca9e";
    const UART_RX = "6e400003-b5a3-f393-e0a9-e50e24dcca9e";

    let rxCharacteristic;

    async function connect() {
      try {
        document.getElementById("status").textContent =
          "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ micro:bit...";

        const device = await navigator.bluetooth.requestDevice({
          filters: [{ namePrefix: "BBC micro:bit" }],
          optionalServices: [UART_SERVICE]
        });

        const server = await device.gatt.connect();
        const service = await server.getPrimaryService(UART_SERVICE);
        rxCharacteristic = await service.getCharacteristic(UART_RX);

        await rxCharacteristic.startNotifications();
        rxCharacteristic.addEventListener(
          "characteristicvaluechanged",
          receiveData
        );

        document.getElementById("status").textContent =
          "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÅ‡∏•‡πâ‡∏ß";

      } catch (error) {
        document.getElementById("status").textContent =
          "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞: ‚ùå ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
      }
    }

    function receiveData(event) {
      const value = event.target.value;
      let text = "";

      for (let i = 0; i < value.byteLength; i++) {
        text += String.fromCharCode(value.getUint8(i));
      }

      document.getElementById("alert").textContent =
        "üö® ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏´‡∏ï‡∏∏: " + text;
    }
  </script>

</body>
</html>
